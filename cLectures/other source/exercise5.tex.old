\documentclass[a4paper,12pt]{article}
\usepackage{amsmath,multicol}
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        \oddsidemargin  -0.5in
        \evensidemargin -0.5in
        \textwidth      7.0in
        \headheight     0.0in
        \topmargin      -1.0in
        \textheight=10.5in
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\begin{center}
\large C for Science - Practical Exercise \#5
\end{center}
The Newton-Raphson method can be used to compute the root of function which we know the derivative of. Given $F(x)$ we find $x^*$ such that $F(x^*) = 0$. The algorithm starts with an initial guess, $x_0$, for the root and calculated an improved guess from the formula:
\begin{equation}
x_{n+1} = x_n - \frac{F(x_n)}{F'(x_n)}, \quad n = 0,1,\ldots
\end{equation}
Iteration stops when a \emph{termination criterion} is met, some common ones include:
\begin{itemize}
\item A maximum number of iterations has been reached (we don't want to wait forever!).
\item $F(x_n)$ is ``close'' to zero.
\item $|x_{n+1}-x_n|$ is ``small''.
\end{itemize}
(also note that we really need $F'(x_n) \neq 0$).
\begin{enumerate}
\item Place the following at the top of your program:
\begin{center}
\tt typedef double (* fx)(double x);
\end{center}
(this is a function pointer to a function which takes in one {\tt double} and returns one {\tt double}).
\item Write a C function to carry out Newton iteration following the prototype:
\begin{center}
\tt int Newton(double * x, fx f, fx df, int max\_its, double tol);
\end{center}
where,
\begin{itemize}
\item {\tt f} is the $F(x)$ function we are trying to solve.
\item {\tt df} corresponds to the derivative of the target function, i.e. $F'(x)$.
\item {\tt max\_its} is the maximum number of iterations that are allowed.
\item {\tt tol} is the algorithm \emph{tolerance}, if either $|F(x_n)| < \mathrm{\tt tol}$ or $|x_{n+1}-x_n| < \mathrm{\tt tol}$, iteration should stop.
\item {\tt x} is a pointer to an initial guess, when the Newton iteration has finished, this should be set to $x_{n+1}$.
\item {\tt Newton} should {\tt return} the number of iterations carried out. \end{itemize}
\item Write a {\tt main} function to
\begin{enumerate}
\item prompt the user for an initial guess, maximum number of iterations and a tolerance.
\item Call the {\tt Newton} function to compute the answer.
\item Print out: $x_{n+1}$ and $F(x_{n+1})$.
\end{enumerate}
\item Test the program with the case $F(x) = x^2-2$ at first, with an initial guess of $x_0=1$:
\begin{enumerate}
\item What is the lowest tolerance setting you can use before the method fails to converge (using fewer than 10 iterations)?
\end{enumerate}
\item Test your solver on the Bessel function (present in GSL and other libraries). Take $F(x) = J_0(x)$, $F'(x) = -J_1(x)$ and try an $x_0 = 2$.
\end{enumerate}

\end{document}
