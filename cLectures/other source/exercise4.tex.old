\documentclass[a4paper,12pt]{article}
\usepackage{amsmath,multicol}
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        \oddsidemargin  -0.5in
        \evensidemargin -0.5in
        \textwidth      7.0in
        \headheight     0.0in
        \topmargin      -1.0in
        \textheight=10.5in
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\begin{center}
\large C for Science - Practical Exercise \#4
\end{center}
The three roots of the \emph{reduced} cubic equation with real coefficients $a_2$, $a_1$ and $a_0$:
\begin{equation}
\label{eq:rcubic}
x^3 + a_2x^2 + a_1x + a_0 = 0
\end{equation}
can either all be real, or can consist of a complex conjugate pair of roots and one real root. To determine which case our cubic belongs to we first compute the quantities $q$ and $r$:
$$q = \frac{a_2^2-3a_1}{9}, \quad r = \frac{2a_2^3-9a_1a_2+27a_0}{54}.$$
\begin{itemize}
\item If $q^3-r^2 < 0$ then two of the roots are complex. The real root in this case is given by:
$$r_\mathrm{real} = -\frac{|r|}{r}\left[\left(\sqrt{r^2-q^3}+|r|\right)^{\frac{1}{3}}
+\frac{q}{\left(\sqrt{r^2-q^3}+|r|\right)^{\frac{1}{3}}}\right]-\frac{a_2}{3}.
$$
\item Conversely, if $q^3-r^2\geq 0$ then all three roots are real. One of the roots is given by:
$$ r_\mathrm{real} = -2\sqrt{q}\cos\left(\frac{1}{3}\cos^{-1}(rq^{-\frac{3}{2}})\right)-\frac{a_2}{3}.$$
\end{itemize}
\begin{enumerate}
\item Write a C function to find the roots of a reduced cubic polynomial that
\begin{enumerate}
\item Determines whether there are 1 or 3 real roots,
\item Finds a single real root using the appropriate formula given above,
\item Calculates the three coefficients of the quadratic obtained from  dividing \eqref{eq:rcubic} by $(x-r_\mathrm{real})$. \emph{Hint}: the quadratic is of the form:
\begin{equation}
\label{eq:rquad}
x^2 + (a_2+r_\mathrm{real})x -\frac{a_0}{r_\mathrm{real}} = 0.
\end{equation}
\item Calculate the two remaining roots by solving \eqref{eq:rquad} with the {\tt quad\_sol} function you developed in a previous exercise. (You will need to ensure that all the cases are dealt with correctly!).
\end{enumerate}

\item Write a C {\tt main} function to:
\begin{enumerate}
\item Prompt for the three coefficients of the reduced cubic equation.
\item Call the cubic polynomial solver you have written.
\item Print out all the roots and their properties.
\end{enumerate}
\item Test your program on the following cubic equations:
\begin{enumerate}
\item $x^3-6x^2+11x-6 = 0$
\item $x^3-4x^2-13x-56=0$
\item $x^3+4x^2+8x+8 = 0$
\end{enumerate}
\end{enumerate}
\vfill
(You will need to use {\tt cos(x)} and {\tt acos(x)} (=$\cos^{-1}(x)$) from {\tt <math.h>}).
\end{document}
